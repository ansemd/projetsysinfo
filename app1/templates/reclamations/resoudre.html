<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>R√©soudre R√©clamation {{ reclamation.numero_reclamation }}</title>
</head>
<body>
    <h1>‚úÖ R√©soudre la R√©clamation {{ reclamation.numero_reclamation }}</h1>
    
    <a href="{% url 'detail_reclamation' reclamation.id %}"><button>‚Üê Retour aux d√©tails</button></a>
    
    <hr>
    
    <!-- Messages d'erreur -->
    {% if messages %}
        {% for message in messages %}
            <p style="color: red; font-weight: bold;">‚ùå {{ message }}</p>
        {% endfor %}
    {% endif %}
    
    <!-- Informations de la r√©clamation -->
    <h2>üìã Informations de la R√©clamation</h2>
    <table border="1" cellpadding="10" style="width: 100%;">
        <tr>
            <th style="width: 25%; background: #f0f0f0;">N¬∞ R√©clamation</th>
            <td><strong style="font-size: 1.1em;">{{ reclamation.numero_reclamation }}</strong></td>
        </tr>
        <tr>
            <th style="background: #f0f0f0;">Client</th>
            <td>{{ reclamation.client.prenom }} {{ reclamation.client.nom }} ({{ reclamation.client.get_id_client }})</td>
        </tr>
        <tr>
            <th style="background: #f0f0f0;">T√©l√©phone</th>
            <td>{{ reclamation.client.telephone }}</td>
        </tr>
        <tr>
            <th style="background: #f0f0f0;">Email</th>
            <td>{{ reclamation.client.email|default:"Non renseign√©" }}</td>
        </tr>
        <tr>
            <th style="background: #f0f0f0;">Objet</th>
            <td><strong>{{ reclamation.objet }}</strong></td>
        </tr>
        <tr>
            <th style="background: #f0f0f0;">Nature</th>
            <td>{{ reclamation.get_nature_display }}</td>
        </tr>
        <tr>
            <th style="background: #f0f0f0;">Priorit√©</th>
            <td>
                {% if reclamation.priorite == 'URGENTE' %}
                    <span style="color: red; font-weight: bold;">üî¥ {{ reclamation.get_priorite_display }}</span>
                {% elif reclamation.priorite == 'ELEVEE' %}
                    <span style="color: orange; font-weight: bold;">üü† {{ reclamation.get_priorite_display }}</span>
                {% elif reclamation.priorite == 'NORMALE' %}
                    <span style="color: blue;">üîµ {{ reclamation.get_priorite_display }}</span>
                {% else %}
                    <span style="color: green;">üü¢ {{ reclamation.get_priorite_display }}</span>
                {% endif %}
            </td>
        </tr>
        <tr>
            <th style="background: #f0f0f0;">Description</th>
            <td style="white-space: pre-wrap; background: #f9f9f9;">{{ reclamation.description }}</td>
        </tr>
        <tr>
            <th style="background: #f0f0f0;">Date cr√©ation</th>
            <td>{{ reclamation.date_creation|date:"d/m/Y √† H:i" }}</td>
        </tr>
    </table>
    
    <hr>
    
    <!-- Alerte compensation -->
    <div style="background: #fff3cd; padding: 15px; border-left: 5px solid #856404; margin: 20px 0;">
        <h3 style="margin-top: 0;">üí∞ Compensation Financi√®re</h3>
        <p>
            <strong>Vous pouvez accorder une compensation au client</strong> si la r√©clamation le justifie :
        </p>
        <ul style="margin: 10px 0;">
            <li>Retard important de livraison</li>
            <li>Dommage au colis</li>
            <li>Service non conforme</li>
            <li>D√©sagr√©ment majeur caus√© au client</li>
        </ul>
        <p style="margin-bottom: 0; color: #856404; font-weight: bold;">
            ‚ö†Ô∏è Le montant de la compensation sera cr√©dit√© au solde du client.
        </p>
    </div>
    
    <hr>
    
    <!-- Formulaire de r√©solution -->
    <h2>üìù Formulaire de R√©solution</h2>
    
    <form method="POST">
        {% csrf_token %}
        
        <table style="width: 100%;">
            {{ form.as_table }}
        </table>
        
        <br>
        
        <button type="submit" style="background: #28a745; color: white; padding: 12px 30px; font-size: 1.1em; font-weight: bold; cursor: pointer;">
            ‚úÖ Marquer comme R√©solue
        </button>
        
        <a href="{% url 'detail_reclamation' reclamation.id %}">
            <button type="button" style="padding: 12px 30px; font-size: 1.1em;">
                ‚ùå Annuler
            </button>
        </a>
    </form>
    
    <hr>
    
    <!-- Informations compl√©mentaires -->
    <div style="background: #d1ecf1; padding: 15px; border-left: 5px solid #0c5460;">
        <h4 style="margin-top: 0;">‚ÑπÔ∏è Que se passe-t-il apr√®s la r√©solution ?</h4>
        <ul style="margin: 10px 0;">
            <li>Le statut de la r√©clamation passera √† <strong>"RESOLUE"</strong></li>
            <li>L'action sera enregistr√©e dans l'historique avec votre nom</li>
            <li>Le d√©lai de traitement sera calcul√© automatiquement</li>
            <li>Si compensation accord√©e : le solde du client sera mis √† jour</li>
            <li>La r√©clamation pourra ensuite √™tre <strong>cl√¥tur√©e d√©finitivement</strong></li>
        </ul>
    </div>
</body>
</html>