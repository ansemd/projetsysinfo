<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S√©lectionner vos favoris - TransportPro</title>
    <script>
        // Limiter la s√©lection √† 4 checkboxes maximum
        function checkLimit() {
            var checkboxes = document.querySelectorAll('input[name="favoris"]:checked');
            var limit = 4;
            
            if (checkboxes.length > limit) {
                alert('Vous ne pouvez s√©lectionner que ' + limit + ' favoris maximum !');
                return false;
            }
            
            if (checkboxes.length === 0) {
                alert('Veuillez s√©lectionner au moins 1 favori !');
                return false;
            }
            
            return true;
        }
    </script>
</head>
<body>
    
    <h1>‚≠ê S√©lectionner vos favoris (max 4)</h1>
    
    <p>
        <a href="{% url 'home' %}">‚Üê Retour au dashboard</a>
    </p>
    
    <hr>
    
    <p><strong>Choisissez jusqu'√† 4 fonctionnalit√©s qui appara√Ætront sur votre dashboard.</strong></p>
    
    <form method="post" onsubmit="return checkLimit()">
        {% csrf_token %}
        
        {% for categorie, fonctionnalites in categories.items %}
            <fieldset style="margin-bottom: 20px;">
                <legend><strong>{{ categorie }}</strong></legend>
                
                {% for fonc in fonctionnalites %}
                    <label style="display: block; margin: 5px 0;">
                        <input 
                            type="checkbox" 
                            name="favoris" 
                            value="{{ fonc.id }}"
                            {% if fonc.id in favoris_actuels %}checked{% endif %}
                        >
                        {{ fonc.icone }} {{ fonc.nom }}
                    </label>
                {% endfor %}
            </fieldset>
        {% endfor %}
        
        <hr>
        
        <button type="submit">üíæ Enregistrer mes favoris</button>
    </form>
    
</body>
</html>